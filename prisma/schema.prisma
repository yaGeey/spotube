generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

generator json {
  provider = "prisma-json-types-generator"
  // output   = "../generated/json-schema"
}

datasource db {
  provider = "sqlite"
}

model SpotifyTrack {
  id            String @id
  title         String
  artists       String // TODO artists
  /// [SpotifyPlaylistItem]
  full_response Json

  default_yt_video    YoutubeVideo? @relation("DefaultVideo", fields: [default_yt_video_id], references: [id])
  default_yt_video_id String?

  youtube_videos YoutubeVideo[]    @relation("TrackVideos")
  playlists      SpotifyPlaylist[]
}

model YoutubeVideo {
  id         String   @id
  updated_at DateTime @default(now()) @updatedAt

  title         String
  author        String
  author_id     String
  duration_ms   Int
  views         Int
  published_at  DateTime
  thumbnail_url String
  ///// [YtFullResponse]
  //full_response Json

  defaultFor       SpotifyTrack[]    @relation("DefaultVideo")
  spotifyTrack     SpotifyTrack?     @relation("TrackVideos", fields: [spotify_id], references: [id])
  spotify_id       String?
  lastFm           LastFM?           @relation(fields: [lastfm_id], references: [id])
  lastfm_id        Int?
  youtubePlaylists YoutubePlaylist[]

  // TODO rewrite
  genius   Genius? @relation(fields: [geniusId], references: [id])
  geniusId Int?
}

model LastFM {
  id            Int            @id @default(autoincrement())
  /// [LastFMTrack]
  track         Json?
  /// [LastFMAlbum]
  album         Json?
  /// [LastFMArtist]
  artist        Json?
  youtubeVideos YoutubeVideo[]
}

model YoutubePlaylist {
  id            String         @id
  title         String
  owner         String
  full_response Json // TODO do I need this?
  content       YoutubeVideo[]

  // localPlaylist   LocalPlaylist[]
}

model SpotifyPlaylist {
  id            String         @id
  snapshot_id   String
  title         String
  owner         String
  thumbnail_url String?
  url           String
  content       SpotifyTrack[]

  // localPlaylists LocalPlaylist[]
}

model AiData {
  id       Int    @id @default(autoincrement())
  title    String
  artist   String
  /// [AiMusicData]
  response Json
}

// TODO
// model LocalPlaylist {
//   id Int @id @default(autoincrement())
//   title            String

//   spotifyPlaylists SpotifyPlaylist[]
//   ytPlaylists      YoutubePlaylist[]
// }

model Genius {
  id            Int            @id @default(autoincrement())
  lyrics        String
  /// [GeniusSong]
  full_response Json
  youtubeVideos YoutubeVideo[]
}
